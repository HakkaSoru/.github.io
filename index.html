<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2Pick Simulator</title>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 2rem;
            background-color: #f3f4f6;
            color: #1f2937;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }

        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 960px;
            gap: 2rem;
        }
        
        .main-content {
            display: flex;
            flex-direction: column;
            width: 100%;
            padding: 2rem;
            background-color: white;
            border-radius: 1rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        h1, h2, h3 {
            color: #111827;
            text-align: center;
        }

        #status-message {
            text-align: center;
            font-size: 1.25rem;
            font-weight: 600;
            color: #4b5563;
        }

        #class-selection, #pick-phase {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .class-buttons, .card-choices-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin-top: 1.5rem;
            width: 100%;
        }

        .class-select-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1rem;
            background-color: #e5e7eb;
            border-radius: 0.75rem;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-sizing: border-box;
            width: 45%;
        }

        .class-select-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
        }

        .card-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            width: 45%;
            padding: 1rem;
            background-color: #e5e7eb;
            border-radius: 0.75rem;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-sizing: border-box;
        }
        
        .card-group:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
        }

        .card-pair {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        .card-name {
            font-weight: 600;
            font-size: 1rem;
            line-height: 1.5;
            text-align: center;
        }

        .card-pair p {
            margin: 0.25rem 0;
            font-size: 0.875rem;
        }

        .button {
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            background-color: #3b82f6;
            color: white;
            border: none;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: background-color 0.2s;
            margin-top: 1rem;
        }

        .button:hover {
            background-color: #2563eb;
        }
        
        #reroll-button {
            background-color: #ef4444;
        }
        
        #reroll-button:hover {
            background-color: #dc2626;
        }
        
        .deck-list-container {
            width: 100%;
            max-width: 400px;
            padding: 1.5rem;
            background-color: #fff;
            border-radius: 1rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .deck-list {
            margin-top: 1rem;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
        }

        .deck-list li {
            padding: 0.5rem 0;
            border-bottom: 1px solid #e5e7eb;
            font-size: 0.95rem;
        }
        
        .deck-list li:last-child {
            border-bottom: none;
        }

        #log {
            margin-top: 2rem;
            padding: 1rem;
            background-color: #e5e7eb;
            border-radius: 0.75rem;
            max-height: 200px;
            overflow-y: auto;
            width: 100%;
        }

        #log p {
            margin: 0.5rem 0;
            border-bottom: 1px dashed #9ca3af;
            padding-bottom: 0.5rem;
            font-size: 0.875rem;
        }
        
        #log p:last-child {
            border-bottom: none;
        }

        .completed-message {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: #10b981;
            margin-top: 2rem;
        }

    </style>
</head>
<body>
    <div class="container">
        <div class="main-content">
            <h1>2Pick シミュレーター</h1>
            <div id="status-message"></div>
            
            <div id="class-selection">
                <h2>クラス選択</h2>
                <div class="class-buttons" id="class-buttons"></div>
            </div>

            <div id="pick-phase" style="display: none;">
                <h2>ピック段階 <span id="pick-count"></span></h2>
                <div class="card-choices-container" id="card-choices-container"></div>
                <button id="reroll-button" class="button">再抽選 (残り <span id="reroll-count">2</span>回)</button>
            </div>
            
            <div class="deck-list-container">
                <h3>デッキリスト</h3>
                <ul id="current-deck" class="deck-list"></ul>
            </div>
            
            <div id="log">
                <h3>ログ</h3>
            </div>
        </div>
    </div>

    <script>
        const neutralCards = [
            { name: "至高の凌駕", rarity: "ブロンズ", group: "new" },
            { name: "干絶の使徒", rarity: "ブロンズ", group: "new" },
            { name: "嘆きに立ちし者", rarity: "シルバー", group: "new" },
            { name: "干絶の顕現ギルネリーゼ", rarity: "レジェンド", group: "new" },
            { name: "勇気に満ちし者", rarity: "ゴールド", group: "new" },
            { name: "試練の石板", rarity: "ゴールド", group: "new" },
            { name: "絶大の顕現マゼルベイン", rarity: "レジェンド", group: "new" },
            { name: "探偵のルーペ", rarity: "ブロンズ", group: "normal" },
            { name: "不屈のファイター", rarity: "ブロンズ", group: "normal" },
            { name: "ベルエンジェルリア", rarity: "ブロンズ", group: "normal" },
            { name: "激震のゴリアテ", rarity: "ブロンズ", group: "normal" },
            { name: "グリードケルブルビィ", rarity: "ブロンズ", group: "normal" },
            { name: "観察の探偵", rarity: "ブロンズ", group: "normal" },
            { name: "ゴブリンの襲撃", rarity: "ブロンズ", group: "normal" },
            { name: "リバースチェンジ", rarity: "ブロンズ", group: "normal" },
            { name: "二刀のゴブリン", rarity: "ブロンズ", group: "normal" },
            { name: "煌響の使者アンリエット", rarity: "シルバー", group: "normal" },
            { name: "冒険者のギルド", rarity: "シルバー", group: "normal" },
            { name: "キャラバンマンモス", rarity: "シルバー", group: "normal" },
            { name: "熾天使の福音", rarity: "シルバー", group: "normal" },
            { name: "迸る光明アポロン", rarity: "シルバー", group: "normal" },
            { name: "メイドエンジェルチェレッタ", rarity: "シルバー", group: "normal" },
            { name: "楽朗の天宮フィルドア", rarity: "ゴールド", group: "normal" },
            { name: "神の雷霆", rarity: "ゴールド", group: "normal" },
            { name: "絆の天使レイナ", rarity: "ゴールド", group: "normal" },
            { name: "雷火の双神フニカル＆ヤヴンハール", rarity: "ゴールド", group: "normal" },
            { name: "勇壮の堕天使オリヴィエ", rarity: "レジェンド", group: "normal" },
            { name: "最果ての罪サタン", rarity: "レジェンド", group: "normal" },
            { name: "颶風の天業グリームニル", rarity: "レジェンド", group: "normal" },
            { name: "運命の黄昏オーディン", rarity: "レジェンド", group: "normal" },
        ];

        const cardData = {
            "エルフ": {
                cards: [
                    ...neutralCards,
                    { name: "樹海の戦士", rarity: "シルバー", group: "new" },
                    { name: "妖精剣の担い手", rarity: "ブロンズ", group: "new" },
                    { name: "野生の猛襲", rarity: "ブロンズ", group: "new" },
                    { name: "不殺の肯定者", rarity: "ブロンズ", group: "new" },
                    { name: "駆逐の死矢", rarity: "ゴールド", group: "new" },
                    { name: "不殺の祈祷者", rarity: "シルバー", group: "new" },
                    { name: "不殺の里", rarity: "シルバー", group: "new" },
                    { name: "不殺の団結者", rarity: "ゴールド", group: "new" },
                    { name: "絶命の顕現エズディア", rarity: "レジェンド", group: "new" },
                    { name: "不殺の継承者クルル", rarity: "レジェンド", group: "new" },
                    { name: "ストレイビーストマン", rarity: "ブロンズ", group: "normal" },
                    { name: "フェアリーテイマー", rarity: "ブロンズ", group: "normal" },
                    { name: "繚乱の庭", rarity: "ブロンズ", group: "normal" },
                    { name: "温厚なるトレント", rarity: "ブロンズ", group: "normal" },
                    { name: "妖精の招集", rarity: "ブロンズ", group: "normal" },
                    { name: "舞い踊る妖精", rarity: "ブロンズ", group: "normal" },
                    { name: "コンタクトフェアリー", rarity: "ブロンズ", group: "normal" },
                    { name: "働きバッタ", rarity: "ブロンズ", group: "normal" },
                    { name: "言の葉のエルダーウィードマン", rarity: "ブロンズ", group: "normal" },
                    { name: "深奥のフェアリービースト", rarity: "ブロンズ", group: "normal" },
                    { name: "ワイルドガール", rarity: "ブロンズ", group: "normal" },
                    { name: "森の行進", rarity: "ブロンズ", group: "normal" },
                    { name: "木槌のドワーフ", rarity: "ブロンズ", group: "normal" },

                    { name: "アドベンチャーエルフメイ", rarity: "シルバー", group: "normal" },
                    { name: "純粋なるウォーターフェアリー", rarity: "シルバー", group: "normal" },
                    { name: "虫の知らせ", rarity: "シルバー", group: "normal" },
                    { name: "ベビーカーバンクル", rarity: "シルバー", group: "normal" },
                    { name: "燐光の岩", rarity: "シルバー", group: "normal" },
                    { name: "薫交の思慕", rarity: "シルバー", group: "normal" },
                    { name: "ソニックアーチャーセルウィン", rarity: "シルバー", group: "normal" },
                    { name: "フロストクリスタリアエリン", rarity: "シルバー", group: "normal" },
                    { name: "樹上からの急襲", rarity: "シルバー", group: "normal" },
                    { name: "アーデントエルフレオネル", rarity: "シルバー", group: "normal" },
                    { name: "フェアリーフェンサー", rarity: "シルバー", group: "normal" },

                    { name: "ピュアクリスタリアリリィ", rarity: "ゴールド", group: "normal" },
                    { name: "殺戮のリノセウス", rarity: "ゴールド", group: "normal" },
                    { name: "聖樹の杖", rarity: "ゴールド", group: "normal" },
                    { name: "薫交の天宮バックウッド", rarity: "ゴールド", group: "normal" },
                    { name: "煌撃の戦士ベイル", rarity: "ゴールド", group: "normal" },
                    { name: "花園の導き", rarity: "ゴールド", group: "normal" },
                    { name: "フォレストシバルリーシンシア", rarity: "ゴールド", group: "normal" },

                    { name: "ビギンズブレイダーアマツ", rarity: "レジェンド", group: "normal" },
                    { name: "自然の妖精姫アリア", rarity: "レジェンド", group: "normal" },
                    { name: "豊麗なるローズクイーン", rarity: "レジェンド", group: "normal" },
                    { name: "翅の女王ティターニア", rarity: "レジェンド", group: "normal" },
                    { name: "絡み付く密林リマーガ", rarity: "レジェンド", group: "normal" },
                ]
            },
            "ロイヤル": {
                cards: [
                    ...neutralCards,
                    { name: "簒奪の祈祷者", rarity: "シルバー", group: "new" },
                    { name: "簒奪の肯定者", rarity: "ブロンズ", group: "new" },
                    { name: "シールドバッシュ", rarity: "ブロンズ", group: "new" },
                    { name: "剣聖の同胞", rarity: "ブロンズ", group: "new" },
                    { name: "簒奪の団結者", rarity: "ゴールド", group: "new" },
                    { name: "スナッピースカウト", rarity: "シルバー", group: "new" },
                    { name: "簒奪のアジト", rarity: "シルバー", group: "new" },
                    { name: "返還の剣閃", rarity: "ゴールド", group: "new" },
                    { name: "空絶の顕現オクトリス", rarity: "レジェンド", group: "new" },
                    { name: "簒奪の継承者シンセライズ", rarity: "レジェンド", group: "new" },
                    
                    { name: "刹那のクイックブレイダー", rarity: "ブロンズ", group: "normal" },
                    { name: "メイドの作法", rarity: "ブロンズ", group: "normal" },
                    { name: "バトルマーチャント", rarity: "ブロンズ", group: "normal" },
                    { name: "ケンタウロスの騎士", rarity: "ブロンズ", group: "normal" },
                    { name: "異端の侍", rarity: "ブロンズ", group: "normal" },
                    { name: "愛の騎士イアン", rarity: "ブロンズ", group: "normal" },
                    { name: "救援のルミナスヒーラーリララ", rarity: "ブロンズ", group: "normal" },
                    { name: "ミリタリードッグ", rarity: "ブロンズ", group: "normal" },
                    { name: "剣士の斬撃", rarity: "ブロンズ", group: "normal" },
                    { name: "ピースディーラーエルネスタ", rarity: "ブロンズ", group: "normal" },
                    { name: "商談成立", rarity: "ブロンズ", group: "normal" },
                    { name: "暗闘のニンジャマスター", rarity: "ブロンズ", group: "normal" },
                    { name: "トリガーメイドセリエ", rarity: "ブロンズ", group: "normal" },

                    { name: "王家の御者", rarity: "シルバー", group: "normal" },
                    { name: "魔煌のトリックスターラスティ", rarity: "シルバー", group: "normal" },
                    { name: "正統なる王冠", rarity: "シルバー", group: "normal" },
                    { name: "統率のルミナスナイト", rarity: "シルバー", group: "normal" },
                    { name: "忍びのムササビ", rarity: "シルバー", group: "normal" },
                    { name: "勇猛のルミナスランサー", rarity: "シルバー", group: "normal" },
                    { name: "王断の威光", rarity: "シルバー", group: "normal" },
                    { name: "卓越のルミナスメイジ", rarity: "シルバー", group: "normal" },
                    { name: "オーディナリーナイトラキル", rarity: "シルバー", group: "normal" },
                    { name: "豪胆なる副団長ゲルト", rarity: "シルバー", group: "normal" },
                    { name: "三将姫の乱撃", rarity: "シルバー", group: "normal" },

                    { name: "サイレントスナイパーワルツ", rarity: "ゴールド", group: "normal" },
                    { name: "王断の天宮スタチウム", rarity: "ゴールド", group: "normal" },
                    { name: "テンタクルバイト", rarity: "ゴールド", group: "normal" },
                    { name: "レヴィオンアックスジェノ", rarity: "ゴールド", group: "normal" },
                    { name: "煌刃の勇者アマリア", rarity: "ゴールド", group: "normal" },
                    { name: "ソードプリンセスロゼ", rarity: "ゴールド", group: "normal" },
                    { name: "休日の王女プリム", rarity: "ゴールド", group: "normal" },

                    { name: "常在戦場カゲミツ", rarity: "レジェンド", group: "normal" },
                    { name: "レヴィオンの迅雷アルベール", rarity: "レジェンド", group: "normal" },
                    { name: "白銀の騎士団長エミリア", rarity: "レジェンド", group: "normal" },
                    { name: "レヴィオンの超越者ユリウス", rarity: "レジェンド", group: "normal" },
                    { name: "静寂のアナテマギルダリア", rarity: "レジェンド", group: "normal" },


                ]
            },
            "ウィッチ": {
                cards: [
                    ...neutralCards,
                    { name: "", rarity: "シルバー", group: "new" },
                    { name: "", rarity: "ブロンズ", group: "new" },
                    { name: "", rarity: "ブロンズ", group: "new" },
                    { name: "", rarity: "ブロンズ", group: "new" },
                    { name: "", rarity: "ゴールド", group: "new" },
                    { name: "", rarity: "シルバー", group: "new" },
                    { name: "", rarity: "シルバー", group: "new" },
                    { name: "", rarity: "ゴールド", group: "new" },
                    { name: "", rarity: "レジェンド", group: "new" },
                    { name: "", rarity: "レジェンド", group: "new" },
                    
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },

                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },

                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },

                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                ]
            },
            "ドラゴン": {
                cards: [
                    ...neutralCards,
                    { name: "", rarity: "シルバー", group: "new" },
                    { name: "", rarity: "ブロンズ", group: "new" },
                    { name: "", rarity: "ブロンズ", group: "new" },
                    { name: "", rarity: "ブロンズ", group: "new" },
                    { name: "", rarity: "ゴールド", group: "new" },
                    { name: "", rarity: "シルバー", group: "new" },
                    { name: "", rarity: "シルバー", group: "new" },
                    { name: "", rarity: "ゴールド", group: "new" },
                    { name: "", rarity: "レジェンド", group: "new" },
                    { name: "", rarity: "レジェンド", group: "new" },
                    
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },

                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },

                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },

                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                ]
            },
            "ナイトメア": {
                cards: [
                    ...neutralCards,
                    { name: "", rarity: "シルバー", group: "new" },
                    { name: "", rarity: "ブロンズ", group: "new" },
                    { name: "", rarity: "ブロンズ", group: "new" },
                    { name: "", rarity: "ブロンズ", group: "new" },
                    { name: "", rarity: "ゴールド", group: "new" },
                    { name: "", rarity: "シルバー", group: "new" },
                    { name: "", rarity: "シルバー", group: "new" },
                    { name: "", rarity: "ゴールド", group: "new" },
                    { name: "", rarity: "レジェンド", group: "new" },
                    { name: "", rarity: "レジェンド", group: "new" },
                    
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },

                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },

                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },

                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                ]
            },
            "ネメシス": {
                cards: [
                    ...neutralCards,
                    { name: "", rarity: "シルバー", group: "new" },
                    { name: "", rarity: "ブロンズ", group: "new" },
                    { name: "", rarity: "ブロンズ", group: "new" },
                    { name: "", rarity: "ブロンズ", group: "new" },
                    { name: "", rarity: "ゴールド", group: "new" },
                    { name: "", rarity: "シルバー", group: "new" },
                    { name: "", rarity: "シルバー", group: "new" },
                    { name: "", rarity: "ゴールド", group: "new" },
                    { name: "", rarity: "レジェンド", group: "new" },
                    { name: "", rarity: "レジェンド", group: "new" },
                    
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },

                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },

                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },

                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                ]
            },
            "ビショップ": {
                cards: [
                    ...neutralCards,
                    { name: "", rarity: "シルバー", group: "new" },
                    { name: "", rarity: "ブロンズ", group: "new" },
                    { name: "", rarity: "ブロンズ", group: "new" },
                    { name: "", rarity: "ブロンズ", group: "new" },
                    { name: "", rarity: "ゴールド", group: "new" },
                    { name: "", rarity: "シルバー", group: "new" },
                    { name: "", rarity: "シルバー", group: "new" },
                    { name: "", rarity: "ゴールド", group: "new" },
                    { name: "", rarity: "レジェンド", group: "new" },
                    { name: "", rarity: "レジェンド", group: "new" },
                    
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },
                    { name: "", rarity: "ブロンズ", group: "normal" },

                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },
                    { name: "", rarity: "シルバー", group: "normal" },

                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },
                    { name: "", rarity: "ゴールド", group: "normal" },

                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                    { name: "", rarity: "レジェンド", group: "normal" },
                ]
            },
        };

        const pickProbability = [
            { rarity: "ブロンズ", groups: { "normal": 1.0 } },
            { rarity: "シルバー", groups: { "normal": 1.0 } },
            { rarity: "ブロンズ", groups: { "normal": 1.0 } },
            { rarity: "シルバー", groups: { "normal": 1.0 } },
            { rarity: "ブロンズ", groups: { "normal": 1.0 } },
            { rarity: "ゴールド", groups: { "normal": 1.0 } },
            { rarity: "ブロンズ", groups: { "normal": 1.0 } },
            { rarity: "シルバー", groups: { "normal": 1.0 } },
            { rarity: "ブロンズ", groups: { "normal": 1.0 } },
            { rarity: "シルバー", groups: { "normal": 1.0 } },
            { rarity: "ブロンズ", groups: { "normal": 1.0 } },
            { rarity: "シルバー", groups: { "normal": 1.0 } },
            { rarity: "ブロンズ", groups: { "normal": 1.0 } },
            { rarity: "ゴールド/レジェンド", groups: { "normal": 1.0 } }
        ];

        const state = {
            currentClass: null,
            deck: {},
            pickCount: 0,
            rerollCount: 2,
            cardsInDeckCount: 0
        };

        const elements = {
            classSelection: document.getElementById('class-selection'),
            pickPhase: document.getElementById('pick-phase'),
            classButtons: document.getElementById('class-buttons'),
            cardChoicesContainer: document.getElementById('card-choices-container'),
            rerollButton: document.getElementById('reroll-button'),
            rerollCount: document.getElementById('reroll-count'),
            pickCountDisplay: document.getElementById('pick-count'),
            currentDeck: document.getElementById('current-deck'),
            log: document.getElementById('log'),
            statusMessage: document.getElementById('status-message'),
        };

        function initializeSimulator() {
            renderClassSelection();
            elements.rerollButton.textContent = `再抽選 (残り ${state.rerollCount}回)`;
        }

        function getGuaranteedCards(className) {
            const classCards = cardData[className].cards;
            const legendCards = classCards.filter(c => c.rarity === "レジェンド");
            const goldCards = classCards.filter(c => c.rarity === "ゴールド");
            const allHighRarityCards = [...legendCards, ...goldCards];

            const card1 = legendCards[Math.floor(Math.random() * legendCards.length)];
            
            let card2 = null;
            let attempts = 0;
            do {
                card2 = allHighRarityCards[Math.floor(Math.random() * allHighRarityCards.length)];
                attempts++;
            } while (card1 && card2 && card1.name === card2.name && attempts < 10);
            
            return [card1, card2];
        }

        function renderClassSelection() {
            elements.classButtons.innerHTML = '';
            for (const className in cardData) {
                const guaranteedCards = getGuaranteedCards(className);
                const button = document.createElement('div');
                button.classList.add('class-select-button');
                button.innerHTML = `
                    <h3>${className}</h3>
                    <p class="card-name">${guaranteedCards[0].name}</p>
                    <p class="card-name">${guaranteedCards[1].name}</p>
                `;
                button.onclick = () => selectClass(className, guaranteedCards);
                elements.classButtons.appendChild(button);
            }
        }

        function selectClass(className, guaranteedCards) {
            state.currentClass = className;
            state.cardsInDeckCount = 0;
            state.deck = {};
            addLog(`>> ${className} クラスを選択しました。`);
            addCardToDeck(guaranteedCards[0]);
            addCardToDeck(guaranteedCards[1]);
            elements.classSelection.style.display = 'none';
            elements.pickPhase.style.display = 'block';
            pickNext();
        }

        function pickNext() {
            if (state.cardsInDeckCount >= 30) {
                endSimulation();
                return;
            }

            state.pickCount++;
            elements.pickCountDisplay.textContent = `${state.pickCount}/14`;

            const choices = getChoicesForPick(state.pickCount - 1);
            renderChoices(choices);
        }

        function getChoicesForPick(pickIndex) {
            const pickInfo = pickProbability[pickIndex];
            const choices = [];

            for (let i = 0; i < 2; i++) {
                const group = weightedRandom(pickInfo.groups);
                const card1 = getRandomCard(pickInfo.rarity, group);
                const card2 = getRandomCard(pickInfo.rarity, group, card1);
                
                if (card1 && card2) {
                    choices.push([card1, card2]);
                } else {
                    choices.push([]);
                }
            }
            return choices;
        }

        function weightedRandom(weights) {
            const totalWeight = Object.values(weights).reduce((sum, w) => sum + w, 0);
            let randomNum = Math.random() * totalWeight;

            for (const group in weights) {
                randomNum -= weights[group];
                if (randomNum <= 0) {
                    return group;
                }
            }
            return Object.keys(weights)[0];
        }

        function getRandomCard(rarity, group, excludeCard = null) {
            const cardPool = cardData[state.currentClass].cards.filter(c => {
                const rarityMatch = rarity === "ゴールド/レジェンド" ?
                    (c.rarity === "ゴールド" || c.rarity === "レジェンド") :
                    c.rarity === rarity;
                const groupMatch = c.group === group;
                const exclusionMatch = excludeCard ? c.name !== excludeCard.name : true;
                return rarityMatch && groupMatch && exclusionMatch;
            });
            if (cardPool.length === 0) {
                return null;
            }
            return cardPool[Math.floor(Math.random() * cardPool.length)];
        }

        function renderChoices(choices) {
            elements.cardChoicesContainer.innerHTML = '';
            choices.forEach(pair => {
                const cardGroupDiv = document.createElement('div');
                cardGroupDiv.classList.add('card-group');
                cardGroupDiv.onclick = () => selectCards(pair);
                
                pair.forEach(card => {
                    const cardDiv = document.createElement('div');
                    cardDiv.classList.add('card-pair');
                    if (card) {
                        cardDiv.innerHTML = `<p class="card-name">${card.name}</p>`;
                    } else {
                        cardDiv.innerHTML = `<p class="card-name">カードなし</p>`;
                    }
                    cardGroupDiv.appendChild(cardDiv);
                });
                elements.cardChoicesContainer.appendChild(cardGroupDiv);
            });
        }

        function selectCards(cards) {
            cards.forEach(card => {
                if (card) {
                    addCardToDeck(card);
                }
            });
            pickNext();
        }
        
        function addCardToDeck(card) {
            if (state.deck[card.name]) {
                state.deck[card.name].count++;
            } else {
                state.deck[card.name] = { ...card, count: 1 };
            }
            state.cardsInDeckCount++;
            addLog(`>> ${card.name} を選択しました。`);
            updateDeckDisplay();
        }

        elements.rerollButton.onclick = () => {
            if (state.rerollCount > 0) {
                state.rerollCount--;
                elements.rerollButton.textContent = `再抽選 (残り ${state.rerollCount}回)`;
                addLog(`>> 再抽選を実行しました。残り${state.rerollCount}回。`);
                
                const rerollChoices = [];
                const allCards = cardData[state.currentClass].cards;
                for (let i = 0; i < 2; i++) {
                    const card1 = allCards[Math.floor(Math.random() * allCards.length)];
                    let card2 = null;
                    let attempts = 0;
                    do {
                        card2 = allCards[Math.floor(Math.random() * allCards.length)];
                        attempts++;
                    } while (card1 && card2 && card1.name === card2.name && attempts < 10);
                    rerollChoices.push([card1, card2]);
                }
                renderChoices(rerollChoices);

            } else {
                addLog(`>> 再抽選回数がありません。`);
            }
        };

        function updateDeckDisplay() {
            elements.currentDeck.innerHTML = '';
            const sortedDeck = Object.values(state.deck).sort((a, b) => a.rarity.localeCompare(b.rarity));
            sortedDeck.forEach(card => {
                const li = document.createElement('li');
                li.textContent = `${card.name} x${card.count}`;
                elements.currentDeck.appendChild(li);
            });
        }

        function endSimulation() {
            elements.pickPhase.style.display = 'none';
            elements.statusMessage.textContent = "デッキが完成しました！";
            addLog(">> デッキ完成！");
        }

        function addLog(message) {
            const p = document.createElement('p');
            p.textContent = message;
            elements.log.prepend(p);
        }

        initializeSimulator();
    </script>
</body>
</html>
